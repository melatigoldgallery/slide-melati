<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tambah Data Baru</title>
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:  #f8fafc; color: #1e293b; line-height: 1.6; padding: 20px; }
    .container { max-width: 600px; margin: 0 auto; }
    .card { background: white; border-radius: 12px; padding: 24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    h2 { margin-bottom: 20px; color: #1e293b; }
    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #475569; font-size: 14px; }
    .form-group input, .form-group select { width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; transition: border-color 0.3s; }
    .form-group input:focus, .form-group select:focus { outline: none; border-color: #2563eb; }
    .form-group small { display: block; margin-top: 5px; color: #64748b; font-size: 12px; }
    .required { color: #ef4444; }
    .form-actions { display: flex; gap: 10px; justify-content: flex-end; margin-top: 30px; }
    .btn { padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
    .btn-primary { background: #2563eb; color: white; }
    .btn-primary:hover { background:  #1d4ed8; }
    .btn-secondary { background: #64748b; color: white; }
    .btn-secondary:hover { background: #475569; }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .notification { position: fixed; top: 20px; right: 20px; padding: 16px 24px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 2000; display: none; max-width: 400px; }
    .notification.success { background: #10b981; color: white; }
    .notification.error { background: #ef4444; color:  white; }
  </style>
</head>
<body>

  <div class="container">
    <div class="card">
      <h2>âž• Tambah Data Pengambilan Baru</h2>
      
      <form id="formTambah" onsubmit="handleSubmit(event); return false;">
        
        <div class="form-group">
          <label>Tanggal:  <span class="required">*</span></label>
          <input type="date" id="tanggal" required>
        </div>

        <div class="form-group">
          <label>Jam:  <span class="required">*</span></label>
          <input type="time" id="jam" required>
        </div>

        <div class="form-group">
          <label>Sales: <span class="required">*</span></label>
          <input type="text" id="sales" required placeholder="Nama sales">
        </div>

        <div class="form-group">
          <label>Nama Barang: <span class="required">*</span></label>
          <input type="text" id="namaBarang" required placeholder="Nama barang">
        </div>

        <div class="form-group">
          <label>Berat: <span class="required">*</span></label>
          <input type="text" id="berat" required placeholder="Contoh: 10 gram">
        </div>

        <div class="form-group">
          <label>Kadar: <span class="required">*</span></label>
          <input type="text" id="kadar" required placeholder="Contoh: 24K, 22K">
        </div>

        <div class="form-group">
          <label>Harga: <span class="required">*</span></label>
          <input type="number" id="harga" required placeholder="0" min="0">
          <small>Masukkan angka tanpa titik atau koma</small>
        </div>

        <div class="form-group" style="background: #f1f5f9; padding: 15px; border-radius: 8px;">
          <p><strong>Catatan:</strong> Foto dapat diupload nanti dari dashboard</p>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary" onclick="window.close()">Batal</button>
          <button type="submit" class="btn btn-primary" id="btnSubmit">ðŸ’¾ Simpan Data</button>
        </div>

      </form>

    </div>
  </div>

  <div id="notification" class="notification"></div>

  <script>
    window.onload = function() {
      var now = new Date();
      document.getElementById('tanggal').value = now.toISOString().split('T')[0];
      document.getElementById('jam').value = now.toTimeString().slice(0, 5);
    };

    function handleSubmit(event) {
      event.preventDefault();

      var formData = {
        tanggal: document.getElementById('tanggal').value,
        jam: document.getElementById('jam').value,
        sales: document.getElementById('sales').value.trim(),
        namaBarang: document.getElementById('namaBarang').value.trim(),
        berat: document.getElementById('berat').value.trim(),
        kadar: document.getElementById('kadar').value.trim(),
        harga: document.getElementById('harga').value
      };

      if (!formData.tanggal || !formData.jam || !formData.sales || 
          !formData.namaBarang || !formData.berat || !formData.kadar || !formData.harga) {
        showNotification('Semua field harus diisi! ', 'error');
        return;
      }

      var btnSubmit = document.getElementById('btnSubmit');
      btnSubmit.disabled = true;
      btnSubmit.textContent = 'Menyimpan...';

      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            showNotification(result.message + ' (No: ' + result.no + ')', 'success');
            
            document.getElementById('formTambah').reset();
            var now = new Date();
            document.getElementById('tanggal').value = now.toISOString().split('T')[0];
            document.getElementById('jam').value = now.toTimeString().slice(0, 5);
            
            btnSubmit.disabled = false;
            btnSubmit.textContent = 'ðŸ’¾ Simpan Data';

            setTimeout(function() {
              window.close();
            }, 2000);
          } else {
            showNotification(result. message, 'error');
            btnSubmit.disabled = false;
            btnSubmit.textContent = 'ðŸ’¾ Simpan Data';
          }
        })
        .withFailureHandler(function(error) {
          showNotification('Error: ' + error.message, 'error');
          btnSubmit.disabled = false;
          btnSubmit.textContent = 'ðŸ’¾ Simpan Data';
        })
        .addNewRecord(formData);
    }

    function showNotification(message, type) {
      var notification = document.getElementById('notification');
      notification.textContent = message;
      notification.className = 'notification ' + type;
      notification.style.display = 'block';
      setTimeout(function() { notification.style.display = 'none'; }, 4000);
    }
  </script>

</body>
</html>